<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/dialog.css">
    <title>线下业务办理指南</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
    <script src="../js/dialog.js"></script>
    <script src="../js/globaldata.js"></script>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.3&key=e31e1eb03a47963714cbad012ae86c9e"></script>
    <style>
        .wrap {
            position: relative;
            padding-top: 80px;
            font-size: 18px;
        }
        
        .xxyw-wrap {
            width: 100%;
            /*height: 100%;*/
            overflow: auto;
            /*padding-bottom: 50px;
            padding-top: 50px;*/
            margin: 50px 0;
            box-sizing: border-box;
            display: flex;
            flex-flow: row wrap;
            align-items: flex-start;
            align-content: flex-start;
            justify-content: space-between;
        }
        
        .xxyw-wrap li {
            width: 45%;
            box-sizing: border-box;
            line-height: 1.5;
            background-color: #565572;
            border-radius: 6px;
            padding: 10px 15px;
            margin-bottom: 15px;
        }
        
        .xxyw-wrap li a {
            color: #fff;
            display: block;
        }
        
        .button-wrap {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
        }
        
        .button {
            box-sizing: border-box;
            padding: 10px 25px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <header>
            <div class="menu-name"><span>大厅</span><i class="sm-icon-arrow"></i><span>线下业务办理指南</span><i class="sm-icon-arrow"></i><span class="xxyw-title">交管业务</span></div>
            <div class="menu-items"><a href="javascript:history.back();"><i class="icon-back" style="margin-bottom:0;margin-right:25px"></i></a><a href="javascript:showItem();"><i class="icon-menus" style="margin-bottom:0;margin-right:25px"></i></a>
                <a href="../index.html"><i class="icon-home" style="margin-bottom:0"></i></a>
            </div>
        </header>
        <ul class="xxyw-wrap">
            <li><a href="../pages/zbjd.html">周边警点一键查询</a></li>
            <li><a href="../pages/sfzbl.html">身份证办理进度查询</a></li>
            <li><a href="../pages/xxyw.html">线下业务办理指南</a></li>
            <li><a href="../pages/wfcx.html">车辆违法查询</a></li>
            <li><a href="../pages/xwdt.html">新闻动态</a></li>
            <li><a href="../pages/crjbl.html">出入境办理进度查询</a></li>
            <li><a href="../pages/cmcx.html">重名查询</a></li>
            <li><a href="../pages/jszcx.html">驾驶证信息查询</a></li>
            <li><a href="../pages/others.html">保安员考试成绩查询</a></li>
            <li><a href="../pages/others.html">保安员证件办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
        </ul>
        <div class="button-wrap">
            <!--<div class="btn button heigher">派出所</div>
            <div class="btn button">交通管理</div>
            <div class="btn button">出入境</div>
            <div class="btn button">出入境</div>-->
        </div>
    </div>
    <div class="mlist-wrap hide">
        <ul class="mlist">
            <li><a href="../pages/zbjd.html">周边警点一键查询</a></li>
            <li><a href="../pages/sfzbl.html">身份证办理进度查询</a></li>
            <li><a href="../pages/xxyw.html">线下业务办理指南</a></li>
            <li><a href="../pages/wfcx.html">车辆违法查询</a></li>
            <li><a href="../pages/xwdt.html">新闻动态</a></li>
            <li><a href="../pages/crjbl.html">出入境办理进度查询</a></li>
            <li><a href="../pages/cmcx.html">重名查询</a></li>
            <li><a href="../pages/jszcx.html">驾驶证信息查询</a></li>
            <li><a href="../pages/others.html">保安员考试成绩查询</a></li>
            <li><a href="../pages/others.html">保安员证件办理进度查询</a></li>
            <li><a href="../pages/others.html">网上事项办理进度查询</a></li>
        </ul>
    </div>
    <script>
        $(".mlist-wrap").click(function() {
            $(".mlist-wrap").toggleClass("hide");
        })

        function showItem() {
            $(".mlist-wrap").toggleClass("hide");
        }
    </script>
</body>
<script src="../js/win_size.js"></script>
<script src="../js/getsearch.js"></script>
<script>
    $(function() {
        var resData;
        var c_index = 0;
        var parm = getSearch.parseURL(location.search);
        console.log(parm);
        var title = parm.cnt;
        var info = {
            "caseKindType": parm.caseKindType,
            "casePoliceCategory": parm.casePoliceCategory
        };
        console.log(title);
        console.log(info);
        $("body").on("click", ".button", function() {
            $(".button").removeClass('heigher');
            $(this).addClass('heigher');
            console.log($(this).data("index"));
            c_index = $(this).data("index");
            let caseType = c_index == 1 ? 2 : 1;
            console.log(caseType);
            if (title == "zayw") {
                info.caseKindType = caseType;
                getList(urlHead1 + url_guide, info);
            } else {
                getList(urlHead2 + jg_index, "");
            };
        });
        // $.ajax({
        //     url: urlHead1 + url_guide,
        //     data: {
        //         "info": JSON.stringify(info)
        //     },
        //     type: 'POST', // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT
        //     dataType: "json",
        //     success: function(res) {
        //         // success
        //         console.log(res);
        //         let resultData = res.resultData; //此处resultData已经是字符串化过的数组
        //         if (res.errCode == "0") {
        //             resData = JSON.parse(resultData);
        //             switch (title) {
        //                 case "traffic":
        //                     break;
        //                 case "zayw":
        //                     for (let i = 0, len = resData.length; i < len; i++) {
        //                         list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
        //                     };
        //                     break;
        //                 case "hzyw":
        //                     break;
        //                 case "crjyw":
        //                     for (let i = 0, len = resData.length; i < len; i++) {
        //                         list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
        //                     };
        //                     break;
        //                 case "xfyw":
        //                     for (let i = 0, len = resData.length; i < len; i++) {
        //                         list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
        //                     };
        //                     break;
        //                 case "kgyw":
        //                     for (let i = 0, len = resData.length; i < len; i++) {
        //                         list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
        //                     };
        //                     break;
        //                 case "wayw":
        //                     for (let i = 0, len = resData.length; i < len; i++) {
        //                         list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
        //                     }
        //                     break;
        //                 default:
        //                     // txt = " jgyw"
        //                     break;
        //             };
        //             $(".xxyw-wrap").html(list_html);
        //         } else {
        //             $.dialog({
        //                 "txt": res.msg
        //             });
        //         }
        //     },
        //     fail: function() {
        //         // fail
        //         $.dialog();
        //     },
        // })
        // console.log(resData);
        var txt, btn_html;
        var list_html = "";
        switch (title) {
            case "traffic":
                txt = "交管业务";
                btn_html = '<div class="btn button heigher" data-index="0">机动车</div> <div class="btn button" data-index="1">驾驶证</div><div class="btn button" data-index="2">违法</div><div class="btn button" data-index="3">校车</div>';
                getList(urlHead2 + jg_index, "");
                break;
            case "crjyw":
                txt = "出入境业务";
                getList(urlHead1 + url_guide, info);
                break;
            case "hzyw":
                txt = "户证业务";
                btn_html = '<div class="btn button heigher" data-index="0">立户与补发</div> <div class="btn button" data-index="1">补发与恢复</div><div class="btn button" data-index="2">变更</div><div class="btn button" data-index="3">迁出与注销</div>';
                getList(urlHead2 + hz_index, "");
                break;
            case "zayw":
                txt = "治安业务";
                btn_html = '<div class="btn button heigher" data-index="1">个人</div> <div class="btn button" data-index="2">企业</div>';
                getList(urlHead1 + url_guide, info);
                break;
            case "xfyw":
                txt = "消防业务";
                getList(urlHead1 + url_guide, info);
                break;
            case "kgyw":
                txt = "监管业务";
                getList(urlHead1 + url_guide, info);
                break;
            case "wayw":
                txt = "网安业务";
                getList(urlHead1 + url_guide, info);
                break;
            default:
                // txt = " jgyw"
                break;
        };
        $(".button-wrap").html(btn_html);
        $(".xxyw-title").text(txt);

        function getList(url, data = info) {
            let list_html = "";
            $.ajax({
                url: url,
                data: {
                    "info": JSON.stringify(data)
                },
                type: 'POST', // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT
                dataType: "json",
                success: function(res) {
                    // success
                    // var res = {
                    //     "resultData": "[{\"children\":[{\"id\":101,\"name\":\"机动车注册\"},{\"id\":102,\"name\":\"机动车年检\"},{\"id\":103,\"name\":\"机动车变更登记\"},{\"id\":104,\"name\":\"机动车转移登记\"},{\"id\":105,\"name\":\"机动车转入登记\"},{\"id\":106,\"name\":\"机动车注销登记\"},{\"id\":107,\"name\":\"机动车质抵押\"},{\"id\":108,\"name\":\"机动车更正业务\"},{\"id\":109,\"name\":\"申\\\\补\\\\换领证照号牌与标志\"},{\"id\":110,\"name\":\"异地营运货车备案\"}],\"id\":1,\"name\":\"机动车\"},{\"children\":[{\"id\":201,\"name\":\"驾驶证申请\"},{\"id\":202,\"name\":\"驾驶证换证\\\\补证\"},{\"id\":203,\"name\":\"驾驶证注销\\n\"},{\"id\":204,\"name\":\"审验证明\"},{\"id\":205,\"name\":\"考试\"},{\"id\":206,\"name\":\"备案\"},{\"id\":207,\"name\":\"恢复驾驶资格\"},{\"id\":208,\"name\":\"临时机动车驾驶许可\"}],\"id\":2,\"name\":\"驾驶证\"},{\"children\":[{\"id\":301,\"name\":\"违法处罚\"}],\"id\":3,\"name\":\"违法\"},{\"children\":[{\"id\":401,\"name\":\"核发校车标牌\"},{\"id\":402,\"name\":\"办理期满换领\\\\损毁换领\\\\丢失\\\\灭失补领校车标牌\"},{\"id\":403,\"name\":\"收回校车标牌\"},{\"id\":404,\"name\":\"申请校车驾驶资格\"},{\"id\":405,\"name\":\"校车驾驶人审验业务\"},{\"id\":407,\"name\":\"申领校车标牌\"},{\"id\":408,\"name\":\"补\\\\换领校车标牌\"},{\"id\":406,\"name\":\"注销校车驾驶资格\"}],\"id\":4,\"name\":\"校车\"}]",
                    //     "errCode": 0,
                    //     "msg": "成功"
                    // };
                    console.log(res);
                    let resultData = res.resultData; //此处resData已经是字符串化过的数组
                    if (res.errCode == "0") {
                        resData = JSON.parse(resultData);
                        console.log(resData);
                        switch (title) {
                            case "traffic":
                                storage.setItem("children", JSON.stringify(resData[c_index].children));
                                for (let i = 0, len = resData[c_index].children.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_h_h.html?cnt=${title}&id=${resData[c_index].children[i].id}">${resData[c_index].children[i].name}</a></li>`;
                                };
                                break;
                            case "zayw":
                                for (let i = 0, len = resData.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
                                };
                                break;
                            case "hzyw":
                                storage.setItem("children", JSON.stringify(resData[c_index].children));
                                for (let i = 0, len = resData[c_index].children.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result2.html?cnt=${title}&id=${resData[c_index].children[i].id}">${resData[c_index].children[i].name}</a></li>`;
                                };
                                break;
                            case "crjyw":
                                for (let i = 0, len = resData.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
                                };
                                break;
                            case "xfyw":
                                for (let i = 0, len = resData.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
                                };
                                break;
                            case "kgyw":
                                for (let i = 0, len = resData.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
                                };
                                break;
                            case "wayw":
                                for (let i = 0, len = resData.length; i < len; i++) {
                                    list_html += `<li><a href="xxyw_result.html?cnt=${title}&guid=${resData[i].guid}">${resData[i].caseName}</a></li>`;
                                }
                                break;
                            default:
                                // txt = " jgyw"
                                break;
                        };
                        $(".xxyw-wrap").html(list_html);
                    } else {
                        $.dialog({
                            "txt": res.msg
                        });
                    }
                },
                fail: function() {
                    // fail
                    $.dialog();
                },
            })
        }
    })
</script>

</html>